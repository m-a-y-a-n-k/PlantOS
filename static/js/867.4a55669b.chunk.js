"use strict";(self.webpackChunkplantos=self.webpackChunkplantos||[]).push([[867],{820:(e,a,t)=>{t.d(a,{A:()=>l});var s=t(43),n=t(579);const i=s.memo(e=>{let{src:a,alt:t,width:i,height:l,className:c="",onClick:o,placeholder:r="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzUwIiBoZWlnaHQ9IjI3NSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjBmMGYwIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkxvYWRpbmcuLi48L3RleHQ+PC9zdmc+",quality:d=.8,loading:m="lazy"}=e;const[h,u]=(0,s.useState)(r),[v,p]=(0,s.useState)(!1),[x,N]=(0,s.useState)("eager"===m),[g,j]=(0,s.useState)(!1),b=(0,s.useRef)(null),f=(0,s.useRef)(null),y=(0,s.useCallback)((e,a)=>new Promise(t=>{const s=document.createElement("canvas"),n=s.getContext("2d"),i=new Image;i.onload=()=>{const e=Math.min(800/i.width,800/i.height);s.width=i.width*e,s.height=i.height*e,null===n||void 0===n||n.drawImage(i,0,0,s.width,s.height);const l=s.toDataURL("image/jpeg",a);t(l)},i.src=e}),[]);(0,s.useEffect)(()=>{if("eager"!==m&&!x)return f.current=new IntersectionObserver(e=>{let[a]=e;var t;a.isIntersecting&&(N(!0),null===(t=f.current)||void 0===t||t.disconnect())},{threshold:.1,rootMargin:"50px"}),b.current&&f.current.observe(b.current),()=>{var e;null===(e=f.current)||void 0===e||e.disconnect()}},[m,x]),(0,s.useEffect)(()=>{if(!x)return;(async()=>{try{if(p(!1),j(!1),a.startsWith("data:image/")){const e=await y(a,d);u(e)}else u(a);p(!0)}catch(e){console.error("Failed to load image:",e),j(!0),u(r)}})()},[a,x,y,d,r]);const C=(0,s.useCallback)(()=>{p(!0)},[]),I=(0,s.useCallback)(()=>{j(!0),u(r)},[r]);return(0,n.jsxs)("div",{className:"optimized-image-container ".concat(c," ").concat(v?"loaded":"loading"," ").concat(g?"error":""),style:{width:i,height:l},onClick:o,children:[(0,n.jsx)("img",{ref:b,src:h,alt:t,className:"optimized-image",onLoad:C,onError:I,loading:m,style:{width:"100%",height:"100%",objectFit:"cover",transition:"opacity 0.3s ease-in-out"}}),!v&&!g&&(0,n.jsx)("div",{className:"image-loading-overlay",children:(0,n.jsx)("div",{className:"loading-spinner"})}),g&&(0,n.jsxs)("div",{className:"image-error-overlay",children:[(0,n.jsx)("span",{children:"\u26a0\ufe0f"}),(0,n.jsx)("p",{children:"Failed to load image"})]})]})});i.displayName="OptimizedImage";const l=i},867:(e,a,t)=>{t.r(a),t.d(a,{default:()=>o});var s=t(43),n=t(56),i=t(820),l=t(579);const c=s.memo(e=>{let{onClose:a,onSelectPlant:t}=e;const{plantHistory:c,removeFromHistory:o,toggleFavorite:r,addNoteToPlant:d}=(0,n.gi)(),[m,h]=(0,s.useState)("all"),[u,v]=(0,s.useState)(""),[p,x]=(0,s.useState)(null),[N,g]=(0,s.useState)(""),j=(0,s.useMemo)(()=>c.filter(e=>{const a="all"===m||"favorites"===m&&e.isFavorite,t=""===u||e.plant.label.toLowerCase().includes(u.toLowerCase())||e.plant.scientificName&&e.plant.scientificName.toLowerCase().includes(u.toLowerCase());return a&&t}),[c,m,u]),b=(0,s.useCallback)(e=>{d(e,N),x(null),g("")},[d,N]),f=(0,s.useCallback)(e=>{x(e.id),g(e.notes||"")},[]),y=(0,s.useCallback)(e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),[]);return(0,l.jsx)("div",{className:"plant-history-overlay",children:(0,l.jsxs)("div",{className:"plant-history-modal",children:[(0,l.jsxs)("div",{className:"plant-history-header",children:[(0,l.jsx)("h2",{children:"\ud83c\udf31 Plant History"}),(0,l.jsx)("button",{className:"close-button",onClick:a,children:"\xd7"})]}),(0,l.jsxs)("div",{className:"plant-history-controls",children:[(0,l.jsx)("div",{className:"search-container",children:(0,l.jsx)("input",{type:"text",placeholder:"Search plants...",value:u,onChange:e=>v(e.target.value),className:"search-input"})}),(0,l.jsxs)("div",{className:"filter-buttons",children:[(0,l.jsxs)("button",{className:"filter-button ".concat("all"===m?"active":""),onClick:()=>h("all"),children:["All (",c.length,")"]}),(0,l.jsxs)("button",{className:"filter-button ".concat("favorites"===m?"active":""),onClick:()=>h("favorites"),children:["Favorites (",c.filter(e=>e.isFavorite).length,")"]})]})]}),(0,l.jsx)("div",{className:"plant-history-content",children:0===j.length?(0,l.jsxs)("div",{className:"empty-state",children:[(0,l.jsx)("div",{className:"empty-icon",children:"\ud83d\udd0d"}),(0,l.jsx)("h3",{children:"No plants found"}),(0,l.jsx)("p",{children:u?'No plants match "'.concat(u,'"'):"favorites"===m?"You haven't favorited any plants yet":"Start identifying plants to build your history!"})]}):(0,l.jsx)("div",{className:"history-grid",children:j.map(e=>(0,l.jsxs)("div",{className:"history-card",children:[(0,l.jsxs)("div",{className:"card-image-container",children:[(0,l.jsx)(i.A,{src:e.capturedImage,alt:e.plant.label,className:"card-image",loading:"lazy",quality:.6,onClick:()=>null===t||void 0===t?void 0:t(e)}),(0,l.jsxs)("div",{className:"card-actions",children:[(0,l.jsx)("button",{className:"favorite-button ".concat(e.isFavorite?"favorited":""),onClick:()=>r(e.id),title:e.isFavorite?"Remove from favorites":"Add to favorites",children:e.isFavorite?"\u2764\ufe0f":"\ud83e\udd0d"}),(0,l.jsx)("button",{className:"delete-button",onClick:()=>o(e.id),title:"Remove from history",children:"\ud83d\uddd1\ufe0f"})]})]}),(0,l.jsxs)("div",{className:"card-content",children:[(0,l.jsx)("h3",{className:"plant-name",children:e.plant.label}),e.plant.scientificName&&(0,l.jsx)("p",{className:"scientific-name",children:(0,l.jsx)("em",{children:e.plant.scientificName})}),(0,l.jsxs)("div",{className:"plant-meta",children:[(0,l.jsx)("span",{className:"confidence",children:e.plant.confidence?"".concat(Math.round(100*e.plant.confidence),"% confident"):"Confidence unknown"}),(0,l.jsxs)("span",{className:"source",children:["via ",e.plant.source]})]}),(0,l.jsx)("p",{className:"timestamp",children:y(e.timestamp)}),(0,l.jsx)("div",{className:"notes-section",children:p===e.id?(0,l.jsxs)("div",{className:"note-editor",children:[(0,l.jsx)("textarea",{value:N,onChange:e=>g(e.target.value),placeholder:"Add your notes about this plant...",className:"note-textarea",rows:3}),(0,l.jsxs)("div",{className:"note-actions",children:[(0,l.jsx)("button",{className:"save-note-button",onClick:()=>b(e.id),children:"Save"}),(0,l.jsx)("button",{className:"cancel-note-button",onClick:()=>{x(null),g("")},children:"Cancel"})]})]}):(0,l.jsxs)("div",{className:"note-display",children:[e.notes?(0,l.jsx)("p",{className:"note-text",children:e.notes}):(0,l.jsx)("p",{className:"no-notes",children:"No notes added"}),(0,l.jsx)("button",{className:"edit-note-button",onClick:()=>f(e),children:e.notes?"Edit Note":"Add Note"})]})})]})]},e.id))})})]})})});c.displayName="PlantHistory";const o=c}}]);
//# sourceMappingURL=867.4a55669b.chunk.js.map