{"version":3,"file":"static/js/527.69003f6f.chunk.js","mappings":"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","sources":["helpers/WebCam/index.ts","helpers/plantDetector.ts","helpers/plantApiService.ts","helpers/fetchPlantInfo.ts","components/DetectedPlantInfo/index.tsx","components/common/AlertBox.tsx","components/Canvas/index.tsx","components/common/OptimizedImage.tsx"],"sourcesContent":["class Webcam {\n  webcamElement: HTMLVideoElement;\n  canvasElement: HTMLCanvasElement;\n\n  constructor(webcamElement: HTMLVideoElement, canvasElement: HTMLCanvasElement) {\n    this.webcamElement = webcamElement;\n    this.canvasElement = canvasElement;\n  }\n\n  adjustVideoSize = (width: number, height: number) => {\n    const aspectRatio = width / height;\n    if (width >= height) {\n      this.webcamElement.width = aspectRatio * this.webcamElement.height;\n    } else {\n      this.webcamElement.height = this.webcamElement.width / aspectRatio;\n    }\n  };\n\n  setup = async (): Promise<void> => {\n    return new Promise<void>((resolve, reject) => {\n      if (navigator.mediaDevices.getUserMedia !== undefined) {\n        navigator.mediaDevices\n          .getUserMedia({\n            audio: false,\n            video: { facingMode: \"environment\" },\n          })\n          .then((mediaStream) => {\n            if (\"srcObject\" in this.webcamElement) {\n              this.webcamElement.srcObject = mediaStream;\n            } else {\n              // For older browsers without the srcObject.\n              (this.webcamElement as any).src = (window.URL as any).createObjectURL(mediaStream);\n            }\n            this.webcamElement.addEventListener(\n              \"loadeddata\",\n              async () => {\n                this.adjustVideoSize(\n                  this.webcamElement.videoWidth,\n                  this.webcamElement.videoHeight\n                );\n                resolve();\n              },\n              false\n            );\n          });\n      } else {\n        reject();\n      }\n    });\n  };\n\n  _drawImage = () => {\n    const imageWidth = this.webcamElement.videoWidth;\n    const imageHeight = this.webcamElement.videoHeight;\n\n    const context = this.canvasElement.getContext(\"2d\");\n    if (!context) {\n      throw new Error(\"Could not get 2D context from canvas\");\n    }\n    \n    this.canvasElement.width = imageWidth;\n    this.canvasElement.height = imageHeight;\n\n    context.drawImage(this.webcamElement, 0, 0, imageWidth, imageHeight);\n    return { imageHeight, imageWidth };\n  };\n\n  takeBlobPhoto = (): Promise<{ blob: Blob | null; imageHeight: number; imageWidth: number }> => {\n    const { imageWidth, imageHeight } = this._drawImage();\n    return new Promise((resolve, reject) => {\n      this.canvasElement.toBlob((blob) => {\n        resolve({ blob, imageHeight, imageWidth });\n      });\n    });\n  };\n\n  takeBase64Photo = ({ type, quality }: { type?: string; quality?: number } = { type: \"png\", quality: 1 }): { base64: string; imageHeight: number; imageWidth: number } => {\n    const { imageHeight, imageWidth } = this._drawImage();\n    // For image/jpeg, `quality` must be between 0 and 1.\n    // Some callers were passing values > 1 which leads to inconsistent results across browsers.\n    const normalizedType = (type || \"png\").toLowerCase();\n    const q =\n      normalizedType === \"jpeg\" || normalizedType === \"jpg\"\n        ? Math.min(1, Math.max(0, quality ?? 0.92))\n        : undefined;\n    const base64 = this.canvasElement.toDataURL(\n      \"image/\" + normalizedType,\n      q as any\n    );\n    return { base64, imageHeight, imageWidth };\n  };\n}\n\nexport default Webcam;\n","import { useEffect, useState } from 'react';\nimport { MLResult } from '../types/plant';\n\n// Declare ml5 global\ndeclare global {\n  interface Window {\n    ml5: any;\n  }\n}\n\nconst ml5 = (window as any).ml5;\n\nfunction loadMl5Classifier(modelName: string): Promise<any> {\n  return new Promise((resolve, reject) => {\n    if (!ml5?.imageClassifier) {\n      reject(new Error('ml5 is not available. Ensure it is loaded in public/index.html'));\n      return;\n    }\n\n    try {\n      // ml5 imageClassifier is callback-based; some builds also return a promise.\n      const maybeClassifier = ml5.imageClassifier(modelName, () => {\n        resolve(maybeClassifier);\n      });\n\n      if (maybeClassifier && typeof maybeClassifier.then === 'function') {\n        (maybeClassifier as Promise<any>).then(resolve).catch(reject);\n      }\n    } catch (e) {\n      reject(e);\n    }\n  });\n}\n\n// Image preprocessing for better plant detection\nfunction preprocessImage(imageElement: HTMLImageElement): HTMLCanvasElement {\n  const canvas = document.createElement('canvas');\n  const ctx = canvas.getContext('2d')!;\n  \n  // Set canvas size to model input requirements\n  canvas.width = 224;\n  canvas.height = 224;\n  \n  // Draw and resize image\n  ctx.drawImage(imageElement, 0, 0, 224, 224);\n  \n  // Apply image enhancements for plant detection\n  const imageData = ctx.getImageData(0, 0, 224, 224);\n  const data = imageData.data;\n  \n  // Enhance green channel for better plant detection\n  for (let i = 0; i < data.length; i += 4) {\n    // Enhance green channel (plants are typically green)\n    data[i + 1] = Math.min(255, data[i + 1] * 1.1);\n    \n    // Reduce noise by slight smoothing\n    if (i > 4 && i < data.length - 4) {\n      const avgR = (data[i - 4] + data[i] + data[i + 4]) / 3;\n      const avgG = (data[i - 3] + data[i + 1] + data[i + 5]) / 3;\n      const avgB = (data[i - 2] + data[i + 2] + data[i + 6]) / 3;\n      \n      data[i] = avgR;\n      data[i + 1] = avgG;\n      data[i + 2] = avgB;\n    }\n  }\n  \n  ctx.putImageData(imageData, 0, 0);\n  return canvas;\n}\n\n// Enhanced detection with multiple models\nasync function detect(base64: string, classifiers: any): Promise<MLResult[]> {\n  const img = new Image();\n  img.src = base64;\n  await img.decode();\n  \n  // Preprocess image for better plant detection\n  const processedCanvas = preprocessImage(img);\n  \n  const results: Array<{ label: string; confidence: number; model: string }> = [];\n  \n  // Use MobileNet for general classification (generic, but fast offline fallback)\n  if (classifiers.mobilenet) {\n    try {\n      const mobileNetResults = await classifiers.mobilenet.classify(processedCanvas);\n      results.push(\n        ...mobileNetResults.map((r: any) => ({\n          label: String(r.label ?? ''),\n          confidence: Number(r.confidence ?? 0),\n          model: 'MobileNet',\n        }))\n      );\n    } catch (error) {\n      console.warn('MobileNet classification failed:', error);\n    }\n  }\n  \n  // Filter and enhance plant-related results\n  const plantKeywords = [\n    'plant', 'leaf', 'flower', 'tree', 'grass', 'herb', 'fern', 'moss',\n    'succulent', 'cactus', 'vine', 'shrub', 'bush', 'weed', 'bloom',\n    'petal', 'stem', 'root', 'seed', 'fruit', 'vegetable', 'crop'\n  ];\n  \n  const plantResults = results.filter((result: any) => \n    plantKeywords.some((keyword: string) => \n      result.label.toLowerCase().includes(keyword)\n    )\n  );\n\n  // If results look \"non-plant\", keep them but don't over-trust them:\n  // return both plant-filtered and unfiltered for upstream logic to decide.\n  const sortedAll = results.sort((a, b) => b.confidence - a.confidence);\n  \n  // If we found plant-specific results, prioritize them\n  if (plantResults.length > 0) {\n    return plantResults.sort((a: any, b: any) => b.confidence - a.confidence);\n  }\n  \n  // Otherwise return all results sorted by confidence\n  return sortedAll;\n}\n\n// Enhanced plant detector hook with multiple models\nexport default function usePlantDetector() {\n  const [classifiers, setClassifiers] = useState({\n    mobilenet: null as any\n  });\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    const initializeModels = async () => {\n      try {\n        setLoading(true);\n        setError(null);\n        \n        // Initialize MobileNet and wait until it's actually ready.\n        const mobilenet = await loadMl5Classifier('MobileNet');\n        \n        setClassifiers({\n          mobilenet\n        });\n        \n        setLoading(false);\n      } catch (err) {\n        setError(err instanceof Error ? err.message : 'Failed to load AI models');\n        setLoading(false);\n      }\n    };\n\n    initializeModels();\n  }, []);\n\n  const ready = !loading && !error && classifiers.mobilenet;\n\n  return { \n    detect, \n    ready, \n    classifiers, \n    loading, \n    error,\n    modelCount: Object.values(classifiers).filter(Boolean).length\n  };\n}","import { PlantDetails, ApiKeys, BaseUrls, CachedData } from '../types/plant';\n\n// Enhanced Plant API Service with multiple providers\nclass PlantApiService {\n  private apiKeys: ApiKeys;\n  private baseUrls: BaseUrls;\n  private cache: Map<string, CachedData<any>>;\n  private cacheTimeout: number;\n\n  constructor() {\n    this.apiKeys = {\n      plantId: process.env.REACT_APP_PLANT_ID_API_KEY,\n      perenual: process.env.REACT_APP_PERENUAL_API_KEY,\n      plantNet: process.env.REACT_APP_PLANTNET_API_KEY\n    };\n    \n    this.baseUrls = {\n      plantId: 'https://api.plant.id/v3',\n      perenual: 'https://perenual.com/api',\n      plantNet: 'https://my-api.plantnet.org/v1',\n      trefle: 'https://trefle.io/api/v1'\n    };\n    \n    this.cache = new Map();\n    this.cacheTimeout = 24 * 60 * 60 * 1000; // 24 hours\n  }\n\n  // Convert base64 image to blob for API upload\n  base64ToBlob(base64String: string): Blob {\n    const byteCharacters = atob(base64String.split(',')[1]);\n    const byteNumbers = new Array(byteCharacters.length);\n    \n    for (let i = 0; i < byteCharacters.length; i++) {\n      byteNumbers[i] = byteCharacters.charCodeAt(i);\n    }\n    \n    const byteArray = new Uint8Array(byteNumbers);\n    return new Blob([byteArray], { type: 'image/jpeg' });\n  }\n\n  // Plant.id API - Most accurate for plant identification\n  async identifyWithPlantId(base64Image: string): Promise<PlantDetails | null> {\n    if (!this.apiKeys.plantId) {\n      throw new Error('Plant.id API key not configured');\n    }\n\n    const blob = this.base64ToBlob(base64Image);\n    const formData = new FormData();\n    \n    formData.append('images', blob);\n    // Plant.id v3 parameters (Kindwise). These enable meaningful health stats.\n    // Note: multipart/form-data values are strings.\n    formData.append('language', 'en');\n    formData.append('health', 'all'); // include identification + health assessment\n    formData.append('disease_level', 'all');\n    formData.append('symptoms', 'true');\n    formData.append('similar_images', 'true');\n    formData.append(\n      'details',\n      [\n        'common_names',\n        'url',\n        'description',\n        'taxonomy',\n        'rank',\n        'gbif_id',\n        'inaturalist_id',\n        'image',\n        'synonyms',\n        'edible_parts',\n        'watering',\n        'propagation_methods',\n      ].join(',')\n    );\n    formData.append(\n      'disease_details',\n      ['common_names', 'classification', 'description', 'treatment', 'local_name'].join(',')\n    );\n\n    try {\n      const response = await fetch(`${this.baseUrls.plantId}/identify`, {\n        method: 'POST',\n        headers: {\n          'Api-Key': this.apiKeys.plantId,\n        },\n        body: formData\n      });\n\n      if (!response.ok) {\n        throw new Error(`Plant.id API error: ${response.status}`);\n      }\n\n      const data = await response.json();\n      return this.formatPlantIdResponse(data);\n    } catch (error) {\n      console.error('Plant.id identification failed:', error);\n      throw error;\n    }\n  }\n\n  // Perenual API - Good for plant care information\n  async getPlantCareInfo(plantName: string): Promise<PlantDetails | null> {\n    if (!this.apiKeys.perenual) {\n      console.warn('Perenual API key not configured, using fallback data');\n      return this.getFallbackPlantInfo(plantName);\n    }\n\n    const cacheKey = `perenual_${plantName}`;\n    const cached = this.getCachedData(cacheKey);\n    if (cached) return cached;\n\n    try {\n      const searchResponse = await fetch(\n        `${this.baseUrls.perenual}/species-list?key=${this.apiKeys.perenual}&q=${encodeURIComponent(plantName)}`\n      );\n\n      if (!searchResponse.ok) {\n        throw new Error(`Perenual search error: ${searchResponse.status}`);\n      }\n\n      const searchData = await searchResponse.json();\n      \n      if (searchData.data && searchData.data.length > 0) {\n        const plantId = searchData.data[0].id;\n        \n        const detailResponse = await fetch(\n          `${this.baseUrls.perenual}/species/details/${plantId}?key=${this.apiKeys.perenual}`\n        );\n\n        if (detailResponse.ok) {\n          const detailData = await detailResponse.json();\n          const formatted = this.formatPerenualResponse(detailData);\n          this.setCachedData(cacheKey, formatted);\n          return formatted;\n        }\n      }\n\n      return this.getFallbackPlantInfo(plantName);\n    } catch (error) {\n      console.error('Perenual API failed:', error);\n      return this.getFallbackPlantInfo(plantName);\n    }\n  }\n\n  // PlantNet API - Open source plant identification\n  async identifyWithPlantNet(base64Image: string): Promise<PlantDetails | null> {\n    if (!this.apiKeys.plantNet) {\n      throw new Error('PlantNet API key not configured');\n    }\n\n    const blob = this.base64ToBlob(base64Image);\n    const formData = new FormData();\n    \n    formData.append('images', blob);\n    formData.append('organs', 'leaf');\n    formData.append('nb-results', '5');\n\n    try {\n      const response = await fetch(\n        `${this.baseUrls.plantNet}/identify/weurope?api-key=${this.apiKeys.plantNet}`,\n        {\n          method: 'POST',\n          body: formData\n        }\n      );\n\n      if (!response.ok) {\n        throw new Error(`PlantNet API error: ${response.status}`);\n      }\n\n      const data = await response.json();\n      return this.formatPlantNetResponse(data);\n    } catch (error) {\n      console.error('PlantNet identification failed:', error);\n      throw error;\n    }\n  }\n\n  // Main identification method that tries multiple APIs\n  async identifyPlant(base64Image: string, plantLabel: string | null = null): Promise<PlantDetails | null> {\n    const results = [];\n\n    // Try Plant.id first (most accurate)\n    try {\n      const plantIdResult = await this.identifyWithPlantId(base64Image);\n      if (plantIdResult && plantIdResult.confidence > 0.3) {\n        results.push({ ...plantIdResult, source: 'Plant.id' });\n      }\n    } catch (error) {\n      console.warn('Plant.id failed, trying alternatives');\n    }\n\n    // Try PlantNet as backup\n    try {\n      const plantNetResult = await this.identifyWithPlantNet(base64Image);\n      if (plantNetResult && plantNetResult.confidence > 0.2) {\n        results.push({ ...plantNetResult, source: 'PlantNet' });\n      }\n    } catch (error) {\n      console.warn('PlantNet failed');\n    }\n\n    // If we have a plant label from ML5, get care info\n    if (plantLabel) {\n      try {\n        const careInfo = await this.getPlantCareInfo(plantLabel);\n        if (careInfo) {\n          results.push({ ...careInfo, source: 'Perenual', fromML: true });\n        }\n      } catch (error) {\n        console.warn('Care info retrieval failed');\n      }\n    }\n\n    // Return best result or fallback\n    if (results.length > 0) {\n      return results.sort((a, b) => (b.confidence || 0) - (a.confidence || 0))[0];\n    }\n\n    return this.getFallbackPlantInfo(plantLabel || 'Unknown Plant');\n  }\n\n  // Format Plant.id API response\n  formatPlantIdResponse(data: any): PlantDetails | null {\n    const suggestion =\n      data?.result?.classification?.suggestions?.[0] ??\n      data?.suggestions?.[0]; // tolerate older response shapes\n\n    if (!suggestion) {\n      return null;\n    }\n\n    const plant = suggestion?.details ?? suggestion?.plant_details ?? {};\n    const taxonomy = plant?.taxonomy ?? {};\n    const isPlant = data?.result?.is_plant ?? data?.result?.isPlant ?? undefined;\n    const isHealthy = data?.result?.is_healthy ?? data?.result?.isHealthy ?? undefined;\n    const disease = data?.result?.disease ?? undefined;\n\n    const diseases =\n      disease?.suggestions?.map((s: any) => ({\n        id: s.id,\n        name: String(s.name ?? 'Unknown issue'),\n        probability: typeof s.probability === 'number' ? s.probability : undefined,\n        nonHarmful: typeof s.non_harmful === 'boolean' ? s.non_harmful : undefined,\n        details: s.details,\n        similarImages: s.similar_images,\n      })) ?? [];\n\n    return {\n      label: plant.common_names?.[0] || plant.scientific_name || suggestion.name,\n      scientificName: plant.scientific_name || suggestion.name,\n      confidence: suggestion.probability,\n      description: plant.description?.value || plant.description || 'No description available',\n      commonNames: plant.common_names || [],\n      family: taxonomy?.family,\n      genus: taxonomy?.genus,\n      watering: plant.watering?.max || plant.watering || 'Regular watering',\n      light: 'Bright indirect light', // Default as not provided by Plant.id\n      propagation: plant.propagation_methods || [],\n      edibleParts: plant.edible_parts || [],\n      image: plant.image?.value || plant.image,\n      gbifId: plant.gbif_id,\n      inaturalistId: plant.inaturalist_id,\n      synonyms: plant.synonyms || [],\n      isPlant: isPlant\n        ? { binary: isPlant.binary, probability: isPlant.probability }\n        : undefined,\n      healthAssessment: isHealthy || diseases.length > 0\n        ? {\n            isHealthy: isHealthy\n              ? { binary: isHealthy.binary, probability: isHealthy.probability }\n              : undefined,\n            diseases,\n            defectScore: disease?.defect_score,\n          }\n        : undefined,\n      source: 'Plant.id',\n    };\n  }\n\n  // Format PlantNet API response\n  formatPlantNetResponse(data: any): PlantDetails | null {\n    if (!data.results || data.results.length === 0) {\n      return null;\n    }\n\n    const result = data.results[0];\n    const species = result.species;\n\n    return {\n      label: species.commonNames?.[0] || species.scientificNameWithoutAuthor,\n      scientificName: species.scientificNameWithoutAuthor,\n      confidence: result.score,\n      description: `${species.genus.scientificNameWithoutAuthor} species`,\n      family: species.family.scientificNameWithoutAuthor,\n      genus: species.genus.scientificNameWithoutAuthor,\n      images: result.images?.map((img: any) => img.url.o) || [],\n      source: 'PlantNet'\n    };\n  }\n\n  // Format Perenual API response\n  formatPerenualResponse(data: any): PlantDetails {\n    return {\n      label: data.common_name || data.scientific_name?.[0],\n      scientificName: data.scientific_name?.[0],\n      confidence: 0.7,\n      description: data.description || 'No description available',\n      watering: data.watering || 'Regular watering',\n      light: data.sunlight?.join(', ') || 'Bright indirect light',\n      source: 'Perenual',\n      care: {\n        hardiness: data.hardiness?.min && data.hardiness?.max \n          ? `Zones ${data.hardiness.min}-${data.hardiness.max}` \n          : 'Unknown',\n        maintenance: data.maintenance || 'Medium',\n        growthRate: data.growth_rate || 'Medium',\n        droughtTolerant: data.drought_tolerant || false,\n        saltTolerant: data.salt_tolerant || false,\n        thorny: data.thorny || false,\n        invasive: data.invasive || false,\n        tropical: data.tropical || false,\n        indoor: data.indoor || false,\n        careLevel: data.care_level || 'Medium'\n      },\n      dimensions: {\n        minHeight: data.dimension?.min_value,\n        maxHeight: data.dimension?.max_value,\n        unit: data.dimension?.unit\n      },\n      image: data.default_image?.original_url,\n      cycle: data.cycle,\n      attracts: data.attracts || [],\n      propagation: data.propagation || [],\n      pruningMonth: data.pruning_month || [],\n      pruningCount: data.pruning_count || [],\n      seeds: data.seeds || 0,\n      flowers: data.flowers || false,\n      flowering_season: data.flowering_season,\n      color: data.flower_color,\n      soilRequirements: data.soil || []\n    };\n  }\n\n  // Fallback plant information when APIs fail\n  getFallbackPlantInfo(plantName: string): PlantDetails {\n    const fallbackData: Record<string, Partial<PlantDetails>> = {\n      'daisy': {\n        label: 'Daisy',\n        scientificName: 'Bellis perennis',\n        description: 'A common flowering plant with white petals and yellow center.',\n        light: 'Full sun to partial shade',\n        watering: 'Regular watering, allow soil to dry between waterings',\n        uses: 'Ornamental, medicinal (traditional use)'\n      },\n      'rose': {\n        label: 'Rose',\n        scientificName: 'Rosa spp.',\n        description: 'Popular flowering shrub known for its fragrant blooms.',\n        light: 'Full sun (6+ hours daily)',\n        watering: 'Deep watering 1-2 times per week',\n        uses: 'Ornamental, cut flowers, essential oils'\n      },\n      'sunflower': {\n        label: 'Sunflower',\n        scientificName: 'Helianthus annuus',\n        description: 'Large flowering plant that follows the sun across the sky.',\n        light: 'Full sun',\n        watering: 'Regular watering, drought tolerant when established',\n        uses: 'Seeds for food and oil, ornamental'\n      }\n    };\n\n    const normalizedName = plantName.toLowerCase().replace(/[^a-z]/g, '');\n    \n    // Try to find a match in fallback data\n    for (const [key, data] of Object.entries(fallbackData)) {\n      if (normalizedName.includes(key) || key.includes(normalizedName)) {\n        return { \n          confidence: 0.5, \n          source: 'Fallback',\n          ...data\n        } as PlantDetails;\n      }\n    }\n\n    // Generic fallback\n    return {\n      label: plantName || 'Unknown Plant',\n      scientificName: 'Species not identified',\n      description: 'This appears to be a plant, but we could not identify the specific species. Consider consulting a local botanist or plant identification expert.',\n      light: 'Varies by species - observe current growing conditions',\n      watering: 'Monitor soil moisture - most plants prefer soil that dries slightly between waterings',\n      uses: 'Unknown - research before consumption or medicinal use',\n      confidence: 0.1,\n      source: 'Generic Fallback'\n    };\n  }\n\n  // Cache management\n  getCachedData(key: string): any {\n    const cached = this.cache.get(key);\n    if (cached && Date.now() - cached.timestamp < this.cacheTimeout) {\n      return cached.data;\n    }\n    return null;\n  }\n\n  setCachedData(key: string, data: any): void {\n    this.cache.set(key, {\n      data,\n      timestamp: Date.now()\n    });\n  }\n\n  clearCache(): void {\n    this.cache.clear();\n  }\n}\n\nconst plantApiService = new PlantApiService();\nexport default plantApiService;\n","import plantApiService from './plantApiService';\nimport { PlantDetails } from '../types/plant';\n\n// Enhanced plant information fetcher with multiple API sources\nexport async function fetchPlantInfo(plantLabel: string, capturedImage: string | null = null): Promise<PlantDetails | null> {\n  try {\n    // If we have a captured image, use it for better identification\n    if (capturedImage) {\n      const result = await plantApiService.identifyPlant(capturedImage, plantLabel);\n      return result;\n    }\n    \n    // Otherwise, just get care information based on the label\n    const result = await plantApiService.getPlantCareInfo(plantLabel);\n    return result;\n    \n  } catch (error) {\n    console.error('Plant info fetch failed:', error);\n    \n    // Return fallback information\n    return plantApiService.getFallbackPlantInfo(plantLabel);\n  }\n}\n\n// Legacy function for backward compatibility\nexport async function fetchPlantInfoLegacy(plantLabel: string): Promise<PlantDetails | null> {\n  try {\n    // Try the old Trefle API approach as a fallback\n    const token = await getToken();\n    const response = await fetch(\n      `https://trefle.io/api/v1/plants?token=${token}&q=${encodeURIComponent(plantLabel)}`,\n      {\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n      }\n    );\n    \n    if (!response.ok) {\n      throw new Error(`Trefle API error: ${response.status}`);\n    }\n    \n    const data = await response.json();\n    \n    if (data.data && data.data.length > 0) {\n      const plant = data.data[0];\n      return {\n        label: plant.common_name || plant.scientific_name,\n        scientificName: plant.scientific_name,\n        confidence: 0.5,\n        description: `${plant.family_common_name || plant.family} family plant`,\n        family: plant.family,\n        genus: plant.genus,\n        image: plant.image_url,\n        source: 'Trefle'\n      };\n    }\n    \n    return null;\n  } catch (error) {\n    console.error('Trefle API failed:', error);\n    return null;\n  }\n}\n\nasync function getToken(): Promise<string> {\n  const params = {\n    origin: window.location.origin,\n    token: process.env.REACT_APP_TREFLE_TOKEN,\n  };\n  \n  try {\n    const response = await fetch(\"https://trefle.io/api/auth/claim\", {\n      method: \"POST\",\n      body: JSON.stringify(params),\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    });\n    \n    if (!response.ok) {\n      throw new Error(`Token request failed: ${response.status}`);\n    }\n    \n    const { token } = await response.json();\n    return token;\n  } catch (error) {\n    console.error('Token generation failed:', error);\n    throw error;\n  }\n}\n","import React, { useEffect, useState } from \"react\";\nimport usePlantDetector from \"../../helpers/plantDetector\";\nimport \"./styles.css\";\nimport { fetchPlantInfo } from \"../../helpers/fetchPlantInfo\";\nimport LoadingSpinner from \"../common/LoadingSpinner\";\nimport { usePlantStore } from \"../../stores/plantStore\";\nimport { PlantDetails } from \"../../types/plant\";\n\ninterface DetectedPlantInfoProps {\n  capturedImage: string;\n  closeDialog: () => void;\n}\n\nconst DetectedPlantInfo: React.FC<DetectedPlantInfoProps> = ({ capturedImage, closeDialog }) => {\n  const { detect, ready, classifiers, loading, error, modelCount } = usePlantDetector();\n  const [plant, setPlant] = useState<PlantDetails | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [detectionError, setDetectionError] = useState<string | null>(null);\n  \n  const { \n    setCurrentPlant, \n    addToHistory, \n    setDetecting, \n    setDetectionProgress, \n    setDetectionStep,\n    preferences \n  } = usePlantStore();\n\n  useEffect(() => {\n    if (ready && capturedImage) {\n      (async () => {\n        try {\n          setIsLoading(true);\n          setDetectionError(null);\n          setDetecting(true);\n          setDetectionStep('Analyzing image with AI models...');\n          setDetectionProgress(10);\n          \n          // First, try ML5 detection\n          const mlResults = await detect(capturedImage, classifiers);\n          setDetectionProgress(40);\n          setDetectionStep('Identifying plant species...');\n          \n          let bestMlResult = null;\n          if (mlResults.length > 0) {\n            bestMlResult = mlResults[0]; // Already sorted by confidence\n          }\n          \n          setDetectionProgress(60);\n          setDetectionStep('Fetching detailed plant information...');\n          \n          // Then get detailed plant info using both ML result and image\n          const plantDetails = await fetchPlantInfo(\n            bestMlResult?.label || 'Unknown Plant',\n            capturedImage\n          );\n          \n          setDetectionProgress(90);\n          setDetectionStep('Finalizing results...');\n          \n          // Combine ML5 confidence with API result\n          if (plantDetails && bestMlResult) {\n            plantDetails.mlConfidence = bestMlResult.confidence;\n            plantDetails.mlModel = bestMlResult.model;\n            plantDetails.combinedConfidence = (\n              (bestMlResult.confidence + (plantDetails.confidence || 0)) / 2\n            );\n          }\n\n          // If the API explicitly thinks this is not a plant, surface a clearer message.\n          if (plantDetails?.isPlant?.binary === false && (plantDetails.isPlant.probability ?? 0) > 0.6) {\n            throw new Error('This image does not appear to contain a plant. Try focusing on leaves/flowers and improving lighting.');\n          }\n          \n          setPlant(plantDetails);\n          setCurrentPlant(plantDetails);\n          setDetectionProgress(100);\n          \n          // Auto-save to history if enabled\n          if (preferences.autoSave && plantDetails) {\n            addToHistory(plantDetails, capturedImage);\n          }\n          \n        } catch (err) {\n          console.error('Plant detection failed:', err);\n          setDetectionError(err instanceof Error ? err.message : 'Detection failed');\n          \n          // Try to get fallback info\n          try {\n            const fallbackInfo = await fetchPlantInfo('Unknown Plant');\n            setPlant(fallbackInfo);\n            setCurrentPlant(fallbackInfo);\n          } catch (fallbackErr) {\n            console.error('Fallback also failed:', fallbackErr);\n          }\n        } finally {\n          setIsLoading(false);\n          setDetecting(false);\n          setDetectionProgress(0);\n          setDetectionStep('');\n        }\n      })();\n    }\n  }, [ready, capturedImage, detect, classifiers, setCurrentPlant, addToHistory, preferences.autoSave, setDetecting, setDetectionProgress, setDetectionStep]);\n\n  const { detectionState } = usePlantStore();\n\n  // Loading state\n  if (loading || isLoading) {\n    return (\n      <div className=\"plant-info-dialog\">\n        <div className=\"plant-info-card\">\n          <span className=\"plant-info-dialog-close\" onClick={closeDialog}>\n            \n          </span>\n          <LoadingSpinner\n            size=\"large\"\n            message={loading ? 'Loading AI models...' : 'Analyzing Plant...'}\n            progress={detectionState.progress}\n            step={detectionState.currentStep}\n          />\n          {modelCount > 0 && (\n            <p className=\"model-info\">Using {modelCount} AI model{modelCount > 1 ? 's' : ''}</p>\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  // Error state\n  if (error || detectionError) {\n    return (\n      <div className=\"plant-info-dialog\">\n        <div className=\"plant-info-card\">\n          <span className=\"plant-info-dialog-close\" onClick={closeDialog}>\n            \n          </span>\n          <h2>Detection Error</h2>\n          <p>We encountered an issue while analyzing your plant:</p>\n          <p className=\"error-message\">{error || detectionError}</p>\n          <p>Please try again with a clearer image of the plant.</p>\n        </div>\n      </div>\n    );\n  }\n\n  // No plant detected\n  if (!plant) {\n    return (\n      <div className=\"plant-info-dialog\">\n        <div className=\"plant-info-card\">\n          <span className=\"plant-info-dialog-close\" onClick={closeDialog}>\n            \n          </span>\n          <h2>Plant Not Detected</h2>\n          <p>We couldn't identify a plant in this image.</p>\n          <p>Please try again with:</p>\n          <ul>\n            <li>A clearer image of the plant</li>\n            <li>Better lighting conditions</li>\n            <li>Focus on leaves, flowers, or distinctive features</li>\n          </ul>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"plant-info-dialog\">\n      <div className=\"plant-info-card\">\n        <span className=\"plant-info-dialog-close\" onClick={closeDialog}>\n          \n        </span>\n        \n        {/* Plant identification header */}\n        <div className=\"plant-header\">\n          <h2 className=\"plant-name\">{plant.label}</h2>\n          {plant.scientificName && (\n            <p className=\"plant-scientific\">\n              <em>{plant.scientificName}</em>\n            </p>\n          )}\n          \n          {/* Confidence and source info */}\n          <div className=\"confidence-info\">\n            {plant.combinedConfidence && (\n              <span className=\"confidence-badge\">\n                {Math.round(plant.combinedConfidence * 100)}% confident\n              </span>\n            )}\n            {plant.source && (\n              <span className=\"source-badge\">\n                via {plant.source}\n              </span>\n            )}\n            {plant.mlModel && (\n              <span className=\"model-badge\">\n                {plant.mlModel}\n              </span>\n            )}\n          </div>\n        </div>\n\n        {/* Plant image */}\n        {plant.image && (\n          <div className=\"plant-image-container\">\n            <img\n              className=\"plant-image\"\n              src={plant.image}\n              alt={plant.label}\n              onError={(e) => {\n                const target = e.target as HTMLImageElement;\n                target.style.display = 'none';\n              }}\n            />\n          </div>\n        )}\n\n        {/* Plant description */}\n        {plant.description && (\n          <div className=\"plant-section\">\n            <h3>Description</h3>\n            <p className=\"plant-description\">{plant.description}</p>\n          </div>\n        )}\n\n        {/* Care information */}\n        <div className=\"care-info\">\n          {plant.light && (\n            <div className=\"care-item\">\n              <strong> Light:</strong> {plant.light}\n            </div>\n          )}\n          {(plant.water || plant.watering) && (\n            <div className=\"care-item\">\n              <strong> Water:</strong> {plant.water || plant.watering}\n            </div>\n          )}\n          {plant.care?.maintenance && (\n            <div className=\"care-item\">\n              <strong> Maintenance:</strong> {plant.care.maintenance}\n            </div>\n          )}\n          {plant.care?.hardiness && (\n            <div className=\"care-item\">\n              <strong> Hardiness:</strong> {plant.care.hardiness}\n            </div>\n          )}\n        </div>\n\n        {/* Health assessment (Plant.id) */}\n        {(plant.healthAssessment?.isHealthy || (plant.healthAssessment?.diseases?.length ?? 0) > 0) && (\n          <div className=\"plant-section\">\n            <h3>Health Assessment</h3>\n            {plant.healthAssessment?.isHealthy && (\n              <p>\n                <strong>Status:</strong>{' '}\n                {plant.healthAssessment.isHealthy.binary ? 'Likely healthy' : 'Potential issues detected'}\n                {typeof plant.healthAssessment.isHealthy.probability === 'number' && (\n                  <> ({Math.round(plant.healthAssessment.isHealthy.probability * 100)}%)</>\n                )}\n              </p>\n            )}\n\n            {(plant.healthAssessment?.diseases?.length ?? 0) > 0 && (\n              <>\n                <p><strong>Top suspected issues:</strong></p>\n                <ul>\n                  {plant.healthAssessment!.diseases!\n                    .slice(0, 3)\n                    .map((d, idx) => (\n                      <li key={`${d.id ?? d.name}_${idx}`}>\n                        {d.name}\n                        {typeof d.probability === 'number' ? ` (${Math.round(d.probability * 100)}%)` : ''}\n                        {d.nonHarmful ? ' (non-harmful)' : ''}\n                      </li>\n                    ))}\n                </ul>\n              </>\n            )}\n          </div>\n        )}\n\n        {/* Additional information */}\n        {(plant.family || plant.genus) && (\n          <div className=\"plant-section\">\n            <h3>Taxonomy</h3>\n            {plant.family && <p><strong>Family:</strong> {plant.family}</p>}\n            {plant.genus && <p><strong>Genus:</strong> {plant.genus}</p>}\n          </div>\n        )}\n\n        {plant.commonNames && plant.commonNames.length > 1 && (\n          <div className=\"plant-section\">\n            <h3>Common Names</h3>\n            <p>{plant.commonNames.join(', ')}</p>\n          </div>\n        )}\n\n        {plant.uses && (\n          <div className=\"plant-section\">\n            <h3>Uses</h3>\n            <p>{plant.uses}</p>\n          </div>\n        )}\n\n        {plant.edibleParts && plant.edibleParts.length > 0 && (\n          <div className=\"plant-section\">\n            <h3> Edible Parts</h3>\n            <p>{plant.edibleParts.join(', ')}</p>\n            <p className=\"warning\">\n              <small>Always verify plant identification before consumption!</small>\n            </p>\n          </div>\n        )}\n\n        {/* Propagation info */}\n        {plant.propagation && plant.propagation.length > 0 && (\n          <div className=\"plant-section\">\n            <h3>Propagation</h3>\n            <p>{plant.propagation.join(', ')}</p>\n          </div>\n        )}\n\n        {/* Debug info for development */}\n        {process.env.NODE_ENV === 'development' && (\n          <details className=\"debug-info\">\n            <summary>Debug Information</summary>\n            <pre>{JSON.stringify(plant, null, 2)}</pre>\n          </details>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default DetectedPlantInfo;\n","import React, { FC, useCallback, useEffect } from \"react\";\nimport \"./AlertBox.css\";\n\nexport interface AlertBoxProps {\n  type?: \"success\" | \"error\" | \"warning\" | \"info\";\n  title?: string;\n  message: string;\n  onClose?: () => void;\n  closable?: boolean;\n  autoClose?: boolean;\n  autoCloseDelay?: number;\n  className?: string;\n}\n\nconst AlertBox: FC<AlertBoxProps> = ({\n  type = \"info\",\n  title,\n  message,\n  onClose,\n  closable = true,\n  autoClose = false,\n  autoCloseDelay = 5000,\n  className = \"\",\n}) => {\n  const [isVisible, setIsVisible] = React.useState(true);\n\n  const handleClose = useCallback(() => {\n    setIsVisible(false);\n    setTimeout(() => {\n      onClose?.();\n    }, 300); // Wait for animation to complete\n  }, [onClose]);\n\n  useEffect(() => {\n    if (autoClose && onClose) {\n      const timer = setTimeout(() => {\n        handleClose();\n      }, autoCloseDelay);\n\n      return () => clearTimeout(timer);\n    }\n  }, [autoClose, autoCloseDelay, onClose, handleClose]);\n\n  if (!isVisible) {\n    return null;\n  }\n\n  const getIcon = () => {\n    switch (type) {\n      case \"success\":\n        return \"\";\n      case \"error\":\n        return \"\";\n      case \"warning\":\n        return \"\";\n      case \"info\":\n      default:\n        return \"\";\n    }\n  };\n\n  return (\n    <div className={`alert-box alert-${type} ${className}`}>\n      <div className=\"alert-content\">\n        <div className=\"alert-icon\">{getIcon()}</div>\n        <div className=\"alert-text\">\n          {title && <div className=\"alert-title\">{title}</div>}\n          <div className=\"alert-message\">{message}</div>\n        </div>\n        {closable && (\n          <button\n            className=\"alert-close\"\n            onClick={handleClose}\n            aria-label=\"Close alert\"\n          >\n            \n          </button>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default AlertBox;\n","import React, {\n  useEffect,\n  useState,\n  useRef,\n  useCallback,\n  useMemo,\n} from \"react\";\nimport Webcam from \"../../helpers/WebCam\";\nimport \"./styles.css\";\nimport DetectedPlantInfo from \"../../components/DetectedPlantInfo\";\nimport LoadingSpinner from \"../common/LoadingSpinner\";\nimport OptimizedImage from \"../common/OptimizedImage\";\nimport {\n  useCurrentPlant,\n  useAutoSavePreference,\n  usePlantActions,\n  useCameraActions,\n} from \"../../stores/plantStore\";\nimport AlertBox from \"../common/AlertBox\";\n\ninterface CanvasProps {\n  offline: boolean;\n}\n\nconst Canvas: React.FC<CanvasProps> = React.memo(({ offline }) => {\n  const [capturedImage, setCapturedImage] = useState<string | null>(null);\n  const [captured, setCaptured] = useState(false);\n  const [uploading, setUploading] = useState(false);\n  const [showDetectedPlantInfo, setShowDetectedPlantInfo] = useState(false);\n  const [alertMessage, setAlertMessage] = useState<string | null>(null);\n\n  const currentPlant = useCurrentPlant();\n  const autoSave = useAutoSavePreference();\n  const { addToHistory, setCurrentPlant } = usePlantActions();\n  const { setCameraActive, setCameraError } = useCameraActions();\n\n  const webcamRef = useRef<HTMLVideoElement>(null);\n  const webcam = useRef<Webcam | null>(null);\n\n  const closeAlert = useCallback(() => {\n    setAlertMessage(null);\n  }, []);\n\n  const captureImage = useCallback(async () => {\n    if (!webcam.current) return;\n\n    try {\n      const capturedData = webcam.current.takeBase64Photo({\n        type: \"jpeg\",\n        quality: 0.9,\n      });\n      setCaptured(true);\n      setCapturedImage(capturedData.base64);\n\n      // Auto-save to history if enabled\n      if (autoSave && currentPlant) {\n        addToHistory(currentPlant, capturedData.base64);\n      }\n    } catch (error) {\n      console.error(\"Failed to capture image:\", error);\n      setCameraError(\"Failed to capture image. Please try again.\");\n    }\n  }, [autoSave, currentPlant, addToHistory, setCameraError]);\n\n  const discardImage = useCallback(() => {\n    setCaptured(false);\n    setCapturedImage(null);\n    setCurrentPlant(null);\n  }, [setCurrentPlant]);\n\n  const checkUploadStatus = useCallback(\n    (data: { status: number }) => {\n      setUploading(false);\n      if (data.status === 200) {\n        // Save to history when uploading\n        if (currentPlant && capturedImage) {\n          addToHistory(currentPlant, capturedImage);\n        }\n        setAlertMessage(\"Plant saved to your collection!\");\n        discardImage();\n      } else {\n        setAlertMessage(\"Sorry, we encountered an error saving your plant\");\n      }\n    },\n    [setUploading, discardImage, currentPlant, capturedImage, addToHistory]\n  );\n\n  const uploadImage = useCallback(() => {\n    if (!capturedImage) return;\n\n    if (offline) {\n      const prefix = \"cloudy_pwa_\";\n      const rs = Math.random().toString(36).substring(2, 5);\n      localStorage.setItem(`${prefix}${rs}`, capturedImage);\n      setAlertMessage(\n        \"Image saved locally, it will be uploaded to your library once internet connection is detected\"\n      );\n      discardImage();\n    } else {\n      setUploading(true);\n      // Simulating upload\n      checkUploadStatus({ status: 200 });\n    }\n  }, [capturedImage, offline, discardImage, checkUploadStatus]);\n\n  const findLocalItems = useCallback((query: RegExp) => {\n    const results: Array<{ key: string; val: string | null }> = [];\n    for (const i in localStorage) {\n      if (localStorage.hasOwnProperty(i)) {\n        if (i.match(query)) {\n          const value = localStorage.getItem(i);\n          localStorage.removeItem(i);\n          results.push({ key: i, val: value });\n        }\n      }\n    }\n    return results;\n  }, []);\n\n  const imageDisplay = useMemo(\n    () =>\n      capturedImage ? (\n        <OptimizedImage\n          src={capturedImage}\n          alt=\"captured plant\"\n          width=\"350\"\n          height=\"275\"\n          quality={0.7}\n          loading=\"eager\"\n        />\n      ) : null,\n    [capturedImage]\n  );\n\n  const updateShowDetectedPlantInfo = useCallback(\n    (show: boolean) => () => {\n      setShowDetectedPlantInfo(show);\n    },\n    []\n  );\n\n  const buttons = useMemo(() => {\n    return captured ? (\n      <div className=\"button-group\">\n        <button className=\"discardButton\" onClick={discardImage}>\n          Discard Plant\n        </button>\n        <button className=\"captureButton\" onClick={captureImage}>\n          Scan Another\n        </button>\n        <button className=\"uploadButton\" onClick={uploadImage}>\n           Save Plant\n        </button>\n        <button\n          className=\"infoButton\"\n          onClick={updateShowDetectedPlantInfo(true)}\n        >\n          Show Plant Info\n        </button>\n      </div>\n    ) : (\n      <button className=\"captureButton\" onClick={captureImage}>\n        Scan Plant\n      </button>\n    );\n  }, [\n    captured,\n    discardImage,\n    captureImage,\n    uploadImage,\n    updateShowDetectedPlantInfo,\n  ]);\n\n  const uploadingMessage = useMemo(\n    () =>\n      uploading ? (\n        <LoadingSpinner\n          message=\"Saving plant to your collection...\"\n          size=\"small\"\n        />\n      ) : null,\n    [uploading]\n  );\n\n  useEffect(() => {\n    // Initialize the camera\n    const canvasElement = document.createElement(\"canvas\");\n    if (webcamRef.current) {\n      webcam.current = new Webcam(webcamRef.current, canvasElement);\n\n      webcam.current\n        .setup()\n        .then(() => {\n          setCameraActive(true);\n          setCameraError(null);\n        })\n        .catch((error) => {\n          console.error(\"Camera setup failed:\", error);\n          setCameraError(\n            \"Error getting access to your camera. Please check permissions.\"\n          );\n          setCameraActive(false);\n        });\n    }\n  }, [setCameraActive, setCameraError]);\n\n  useEffect(() => {\n    const batchUploads = () => {\n      const images = findLocalItems(/^cloudy_pwa_/);\n      let error = false;\n      if (images.length > 0) {\n        setUploading(true);\n        images.forEach((image) => {\n          // Simulating upload\n          checkUploadStatus({ status: 200 });\n        });\n        setUploading(false);\n        if (!error) {\n          setAlertMessage(\n            \"All saved images have been uploaded to your Library\"\n          );\n        }\n      }\n    };\n    if (!offline) {\n      batchUploads();\n    }\n  }, [offline, checkUploadStatus, findLocalItems]);\n\n  return (\n    <div className=\"uploadCanvas\">\n      <div className=\"scan-card\">\n        <div className=\"mediaGroup\">\n          <video\n            autoPlay\n            playsInline\n            muted\n            ref={webcamRef}\n            width=\"100vw\"\n            height=\"275\"\n          />\n          {imageDisplay && (\n            <figure className=\"imageCanvas\">\n              {imageDisplay}\n              <figcaption>Image captured from feed.</figcaption>\n            </figure>\n          )}\n        </div>\n\n        {!captured && (\n          <p className=\"scan-hint\">\n            Tip: fill the frame with leaves/flowers for best results.\n          </p>\n        )}\n\n        {buttons}\n        {uploadingMessage}\n        {alertMessage && (\n          <AlertBox\n            type=\"info\"\n            message={alertMessage}\n            onClose={closeAlert}\n          />\n        )}\n      </div>\n      {showDetectedPlantInfo && capturedImage && (\n        <DetectedPlantInfo\n          capturedImage={capturedImage}\n          closeDialog={updateShowDetectedPlantInfo(false)}\n        />\n      )}\n    </div>\n  );\n});\n\nCanvas.displayName = \"Canvas\";\n\nexport default Canvas;\n","import React, { useState, useRef, useEffect, useCallback } from 'react';\nimport './OptimizedImage.css';\n\ninterface OptimizedImageProps {\n  src: string;\n  alt: string;\n  width?: number | string;\n  height?: number | string;\n  className?: string;\n  onClick?: () => void;\n  placeholder?: string;\n  quality?: number;\n  loading?: 'lazy' | 'eager';\n}\n\nconst OptimizedImage: React.FC<OptimizedImageProps> = React.memo(({\n  src,\n  alt,\n  width,\n  height,\n  className = '',\n  onClick,\n  placeholder = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzUwIiBoZWlnaHQ9IjI3NSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjBmMGYwIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkxvYWRpbmcuLi48L3RleHQ+PC9zdmc+',\n  quality = 0.8,\n  loading = 'lazy'\n}) => {\n  const [imageSrc, setImageSrc] = useState<string>(placeholder);\n  const [isLoaded, setIsLoaded] = useState(false);\n  const [isInView, setIsInView] = useState(loading === 'eager');\n  const [hasError, setHasError] = useState(false);\n  const imgRef = useRef<HTMLImageElement>(null);\n  const observerRef = useRef<IntersectionObserver | null>(null);\n\n  // Compress image if it's a base64 string\n  const compressImage = useCallback((base64: string, quality: number): Promise<string> => {\n    return new Promise((resolve) => {\n      const canvas = document.createElement('canvas');\n      const ctx = canvas.getContext('2d');\n      const img = new Image();\n      \n      img.onload = () => {\n        // Calculate new dimensions (max 800px width)\n        const maxWidth = 800;\n        const ratio = Math.min(maxWidth / img.width, maxWidth / img.height);\n        canvas.width = img.width * ratio;\n        canvas.height = img.height * ratio;\n        \n        // Draw and compress\n        ctx?.drawImage(img, 0, 0, canvas.width, canvas.height);\n        const compressedBase64 = canvas.toDataURL('image/jpeg', quality);\n        resolve(compressedBase64);\n      };\n      \n      img.src = base64;\n    });\n  }, []);\n\n  // Intersection Observer for lazy loading\n  useEffect(() => {\n    if (loading === 'eager' || isInView) return;\n\n    observerRef.current = new IntersectionObserver(\n      ([entry]) => {\n        if (entry.isIntersecting) {\n          setIsInView(true);\n          observerRef.current?.disconnect();\n        }\n      },\n      { threshold: 0.1, rootMargin: '50px' }\n    );\n\n    if (imgRef.current) {\n      observerRef.current.observe(imgRef.current);\n    }\n\n    return () => {\n      observerRef.current?.disconnect();\n    };\n  }, [loading, isInView]);\n\n  // Load and compress image when in view\n  useEffect(() => {\n    if (!isInView) return;\n\n    const loadImage = async () => {\n      try {\n        setIsLoaded(false);\n        setHasError(false);\n\n        // If it's a base64 image, compress it\n        if (src.startsWith('data:image/')) {\n          const compressedSrc = await compressImage(src, quality);\n          setImageSrc(compressedSrc);\n        } else {\n          setImageSrc(src);\n        }\n        \n        setIsLoaded(true);\n      } catch (error) {\n        console.error('Failed to load image:', error);\n        setHasError(true);\n        setImageSrc(placeholder);\n      }\n    };\n\n    loadImage();\n  }, [src, isInView, compressImage, quality, placeholder]);\n\n  const handleImageLoad = useCallback(() => {\n    setIsLoaded(true);\n  }, []);\n\n  const handleImageError = useCallback(() => {\n    setHasError(true);\n    setImageSrc(placeholder);\n  }, [placeholder]);\n\n  return (\n    <div \n      className={`optimized-image-container ${className} ${isLoaded ? 'loaded' : 'loading'} ${hasError ? 'error' : ''}`}\n      style={{ width, height }}\n      onClick={onClick}\n    >\n      <img\n        ref={imgRef}\n        src={imageSrc}\n        alt={alt}\n        className=\"optimized-image\"\n        onLoad={handleImageLoad}\n        onError={handleImageError}\n        loading={loading}\n        style={{ \n          width: '100%', \n          height: '100%', \n          objectFit: 'cover',\n          transition: 'opacity 0.3s ease-in-out'\n        }}\n      />\n      {!isLoaded && !hasError && (\n        <div className=\"image-loading-overlay\">\n          <div className=\"loading-spinner\" />\n        </div>\n      )}\n      {hasError && (\n        <div className=\"image-error-overlay\">\n          <span></span>\n          <p>Failed to load image</p>\n        </div>\n      )}\n    </div>\n  );\n});\n\nOptimizedImage.displayName = 'OptimizedImage';\n\nexport default OptimizedImage;\n"],"names":["constructor","webcamElement","canvasElement","_this","adjustVideoSize","width","height","aspectRatio","this","setup","async","Promise","resolve","reject","undefined","navigator","mediaDevices","getUserMedia","audio","video","facingMode","then","mediaStream","srcObject","src","window","URL","createObjectURL","addEventListener","videoWidth","videoHeight","_drawImage","imageWidth","imageHeight","context","getContext","Error","drawImage","takeBlobPhoto","toBlob","blob","takeBase64Photo","type","quality","arguments","length","normalizedType","toLowerCase","q","Math","min","max","base64","toDataURL","ml5","detect","classifiers","img","Image","decode","processedCanvas","imageElement","canvas","document","createElement","ctx","imageData","getImageData","data","i","avgR","avgG","avgB","putImageData","preprocessImage","results","mobilenet","mobileNetResults","classify","push","map","r","_r$label","_r$confidence","label","String","confidence","Number","model","error","console","warn","plantKeywords","plantResults","filter","result","some","keyword","includes","sortedAll","sort","a","b","usePlantDetector","setClassifiers","useState","loading","setLoading","setError","useEffect","modelName","imageClassifier","maybeClassifier","catch","e","err","message","initializeModels","ready","modelCount","Object","values","Boolean","apiKeys","baseUrls","cache","cacheTimeout","plantId","process","REACT_APP_PLANT_ID_API_KEY","perenual","REACT_APP_PERENUAL_API_KEY","plantNet","REACT_APP_PLANTNET_API_KEY","trefle","Map","base64ToBlob","base64String","byteCharacters","atob","split","byteNumbers","Array","charCodeAt","byteArray","Uint8Array","Blob","identifyWithPlantId","base64Image","formData","FormData","append","join","response","fetch","concat","method","headers","body","ok","status","json","formatPlantIdResponse","getPlantCareInfo","plantName","getFallbackPlantInfo","cacheKey","cached","getCachedData","searchResponse","encodeURIComponent","searchData","id","detailResponse","detailData","formatted","formatPerenualResponse","setCachedData","identifyWithPlantNet","formatPlantNetResponse","identifyPlant","plantLabel","plantIdResult","_objectSpread","source","plantNetResult","careInfo","fromML","_data$result$classifi","_data$result","_data$result$classifi2","_data$result$classifi3","_data$suggestions","_ref","_suggestion$details","_plant$taxonomy","_ref2","_data$result$is_plant","_data$result2","_data$result3","_ref3","_data$result$is_healt","_data$result4","_data$result5","_data$result$disease","_data$result6","_disease$suggestions$","_disease$suggestions","_plant$common_names","_plant$description","_plant$watering","_plant$image","suggestion","classification","suggestions","plant","details","plant_details","taxonomy","isPlant","is_plant","isHealthy","is_healthy","disease","diseases","s","_s$name","name","probability","nonHarmful","non_harmful","similarImages","similar_images","common_names","scientific_name","scientificName","description","value","commonNames","family","genus","watering","light","propagation","propagation_methods","edibleParts","edible_parts","image","gbifId","gbif_id","inaturalistId","inaturalist_id","synonyms","binary","healthAssessment","defectScore","defect_score","_species$commonNames","_result$images","species","scientificNameWithoutAuthor","score","images","url","o","_data$scientific_name","_data$scientific_name2","_data$sunlight","_data$hardiness","_data$hardiness2","_data$dimension","_data$dimension2","_data$dimension3","_data$default_image","common_name","sunlight","care","hardiness","maintenance","growthRate","growth_rate","droughtTolerant","drought_tolerant","saltTolerant","salt_tolerant","thorny","invasive","tropical","indoor","careLevel","care_level","dimensions","minHeight","dimension","min_value","maxHeight","max_value","unit","default_image","original_url","cycle","attracts","pruningMonth","pruning_month","pruningCount","pruning_count","seeds","flowers","flowering_season","color","flower_color","soilRequirements","soil","fallbackData","uses","normalizedName","replace","key","entries","get","Date","now","timestamp","set","clearCache","clear","fetchPlantInfo","capturedImage","plantApiService","_plant$care","_plant$care2","_plant$healthAssessme","_plant$healthAssessme2","_plant$healthAssessme3","_plant$healthAssessme4","_plant$healthAssessme5","_plant$healthAssessme6","_plant$healthAssessme7","_plant$healthAssessme8","closeDialog","setPlant","isLoading","setIsLoading","detectionError","setDetectionError","setCurrentPlant","addToHistory","setDetecting","setDetectionProgress","setDetectionStep","preferences","usePlantStore","_bestMlResult","_plantDetails$isPlant","_plantDetails$isPlant2","mlResults","bestMlResult","plantDetails","mlConfidence","mlModel","combinedConfidence","autoSave","fallbackInfo","fallbackErr","detectionState","_jsx","className","children","_jsxs","onClick","LoadingSpinner","size","progress","step","currentStep","round","alt","onError","target","style","display","water","_Fragment","slice","d","idx","_d$id","title","onClose","closable","autoClose","autoCloseDelay","isVisible","setIsVisible","React","handleClose","useCallback","setTimeout","timer","clearTimeout","getIcon","Canvas","offline","setCapturedImage","captured","setCaptured","uploading","setUploading","showDetectedPlantInfo","setShowDetectedPlantInfo","alertMessage","setAlertMessage","currentPlant","useCurrentPlant","useAutoSavePreference","usePlantActions","setCameraActive","setCameraError","useCameraActions","webcamRef","useRef","webcam","closeAlert","captureImage","current","capturedData","discardImage","checkUploadStatus","uploadImage","prefix","rs","random","toString","substring","localStorage","setItem","findLocalItems","query","hasOwnProperty","match","getItem","removeItem","val","imageDisplay","useMemo","OptimizedImage","updateShowDetectedPlantInfo","show","buttons","uploadingMessage","Webcam","batchUploads","forEach","autoPlay","playsInline","muted","ref","AlertBox","DetectedPlantInfo","displayName","placeholder","imageSrc","setImageSrc","isLoaded","setIsLoaded","isInView","setIsInView","hasError","setHasError","imgRef","observerRef","compressImage","onload","ratio","compressedBase64","IntersectionObserver","entry","_observerRef$current","isIntersecting","disconnect","threshold","rootMargin","observe","_observerRef$current2","startsWith","compressedSrc","loadImage","handleImageLoad","handleImageError","onLoad","objectFit","transition"],"sourceRoot":""}